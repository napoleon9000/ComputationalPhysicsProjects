clear
clc
clear class
hold on

movieFlag = 0;
h = 0.0005;    % time step
movieInt = 20;   
maxStep = 50;  % years
Sun = planet('Sun',1,[ 3.771026244390675E-03,  2.043097224215272E-03, -1.627192490003819E-04],[-3.77E-05, 2.55E-03, -2.71E-06]);
% Mercury = planet('Mercury',1.2e-7,[0.39,0,0],[0,9.96,0]);
Mercury = planet('Mercury',1.66051E-07,[1.863515519979501E-01,  2.548065003154470E-01,  3.740439308464503E-03],[-2.840110528355240E-02*365.25, 1.762706954908617E-02*365.25, 4.045318985205311E-03*365.25]);
Venus = planet('Venus',2.44827E-06,[6.402610421995966E-01, -3.487130058678541E-01, -4.170129005991170E-02],[9.643270647275807E-03*365.25, 1.763763269124911E-02*365.25, -3.147583648494046E-04*365.25]);
Earth = planet('Earth',3.0033E-06,[-9.722793854254226E-01, -2.136194298311388E-01, -1.524486237461527E-04],[ 1.25E+00,	-6.16E+00, 3.77E-04]);
Mars = planet('Mars',3.22774E-07,[ -1.273888286335226E+00, -9.345650995929446E-01,  1.156708511527438E-02],[8.796919824227780E-03*365.25, -1.008219489094120E-02*365.25, -4.273358411290152E-04*365.25]);
Jupiter = planet('Jupiter',0.000954533,[-5.343374723296717E+00,  9.499090356431010E-01,  1.155500089211299E-01],[-1.408034735202547E-03*365.25, -7.074583503958680E-03*365.25,  6.088651310975759E-05*365.25]);
Saturn = planet('Saturn',0.000285797,[-3.257658796800622E+00, -9.469829247085269E+00, 2.943053689076774E-01],[4.969350447804316E-03*365.25, -1.831261754069796E-03*365.25, -1.661687950774069E-04*365.25]);
Uranus = planet('Uranus',4.36552E-05,[1.874773642797683E+01,  6.878729814152105E+00, -2.173332521506558E-01],[-1.383418038561912E-03*365.25, 3.509051475538068E-03*365.25, 3.101068527811424E-05*365.25]);
Neptune = planet('Neptune',5.15e-5,[2.805523791636490E+01, -1.050433698717797E+01, -4.302448968580886E-01],[1.079523475180545E-03*365.25,  2.958063165703507E-03*365.25, -8.594624381715380E-05*365.25]);
Pluto = planet('Pluto',6.57265E-09,[8.819727426071946E+00, -3.186049668958540E+01, 8.580737574573666E-01],[3.083142612945824E-03*365.25, 1.793117968432260E-04*365.25, -9.202762004669122E-04*365.25]);

Moon = planet('Moon',(7.347/1.989)*1e-8,[1.00256955529 0 0],[0 (1+1.022/30)*6.28 0]);


% Add planets
S = solarSystem;
S = S.godSettings(h, maxStep);
S = S.addPlanet(Sun);
S = S.addPlanet(Mercury);
S = S.addPlanet(Venus);
S = S.addPlanet(Earth);
S = S.addPlanet(Mars);
S = S.addPlanet(Jupiter);
S = S.addPlanet(Saturn);
S = S.addPlanet(Uranus);
S = S.addPlanet(Neptune);
S = S.addPlanet(Pluto);
% S = S.addPlanet(Moon);
% S = S.addPlanet(Sun2);
% S = S.addPlanet(Sun3);


% S = S.verlet;
%% Run
step = 1;
while(S.currentStep*h <= maxStep)
    S = S.verletRT;
%     S = S.verlet;
    if(mod(step,movieInt) == 0&& movieFlag == 1)
        S.show;
        pause(0.01)
    end
    if(mod(step,1000) == 0)
        disp(S.currentStep*h/maxStep)
    end
    step = step + 1;
end
S.show;
% S.perihelion(2);
% figure
% S.plotE([2 4 5]);
finishNotice(1);